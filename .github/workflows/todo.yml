name: Sync Todo

on:
    schedule:
        - cron: "0 9 * * *" # every day at 09:00 UTC
    workflow_dispatch:

jobs:
    sync-todo:
        runs-on: ubuntu-latest

        steps:
            - name: Checkout repo
              uses: actions/checkout@v4
              with:
                  persist-credentials: false

            - name: Configure Git
              run: |
                  git config user.name "github-actions"
                  git config user.email "github-actions@users.noreply.github.com"

            - name: Update Todo
              run: |
                  echo "- [ ] Synced at $(date -u)" >> Todo.md

            - name: Commit changes
              run: |
                  git add Todo.md
                  git commit -m "chore: sync todo ($(date -u))" || echo "No changes to commit"

            - name: Push changes with PAT
              run: |
                  git push https://x-access-token:${{ secrets.GH_PAT }}@github.com/${{ github.repository }} HEAD:main
